{"version":3,"file":"component---src-pages-checkout-js-3a857f5965d965619436.js","mappings":"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","sources":["webpack://indiaohyes/./src/pages/checkout.js"],"sourcesContent":["import { Link, navigate } from 'gatsby'\r\nimport React, { useState, useEffect } from 'react';\r\nimport axios, { URL } from '../services/api';\r\nimport isLoggedIn from '../services/auth';\r\n\r\n\r\nfunction loadScript(src) {\r\n    return new Promise((resolve) => {\r\n        const script = document.createElement('script')\r\n        script.src = src\r\n        script.onload = () => {\r\n            resolve(true)\r\n        }\r\n        script.onerror = () => {\r\n            resolve(false)\r\n        }\r\n        document.body.appendChild(script)\r\n    })\r\n}\r\n\r\nconst Checkout = () => {\r\n\r\n    const [Details, setDetails] = useState();\r\n    \r\n    const [addressFormDisplay, setAddressFormDisplay] = useState();\r\n    const [user, setUser] = useState();\r\n    const [cart, setCart] = useState();\r\n    const [SelectedItems, setSelectedItems] = useState();\r\n\r\n    useEffect(() => {\r\n        if (!isLoggedIn())\r\n            return navigate('/login');\r\n\r\n        axios\r\n            .get('/users/cart')\r\n            .then(res => {\r\n                setDetails(res.data.data.cart)\r\n\r\n            })\r\n            .catch(err => {\r\n                setDetails([]);\r\n                console.log(err.response);\r\n            });\r\n\r\n\r\n        axios\r\n            .get('/order')\r\n            .then(res => {\r\n\r\n\r\n            })\r\n            .catch(err => {\r\n\r\n                console.log(err.response);\r\n            });\r\n\r\n\r\n        axios\r\n            .get('/users/me')\r\n            .then(res => {\r\n                setUser(res.data.data.user);\r\n            })\r\n            .catch(err => {\r\n                setUser({});\r\n                navigate('/login');\r\n                console.log(err.response);\r\n            });\r\n\r\n        axios\r\n            .get('/users/cart')\r\n            .then(res => setCart(res.data.data.cart))\r\n            .catch(err => {\r\n                setCart([]);\r\n                console.log(err.response);\r\n            });\r\n\r\n    }, []);\r\n\r\n\r\n    async function displayRazorpay() {\r\n        const res = await loadScript('https://checkout.razorpay.com/v1/checkout.js')\r\n\r\n        if (!res) {\r\n            alert('Razorpay SDK failed to load. Are you online?')\r\n            return\r\n        }\r\n\r\n        const data = await fetch('http://localhost:3000/api/order', { method: 'POST' }).then((t) =>\r\n            t.json()\r\n        )\r\n\r\n        console.log(data)\r\n        \r\n\r\n\r\n        const options = {\r\n            key: 'rzp_test_riR65g07X6XqfK',\r\n            currency: data.currency,\r\n            amount: data.amount,\r\n            order_id: data.o_id,\r\n            name: 'Donation',\r\n            description: 'Thank you for nothing. Please give us some money',\r\n            image: '',\r\n            handler: function (response) {\r\n                if (response.razorpay_payment_id != null) {\r\n\r\n                    axios\r\n                        .post('/placeorder/place-order',{\r\n\r\n                            payment_id : response.razorpay_payment_id,\r\n                            razorpay_signature : response.razorpay_signature,\r\n                            oder_id : data.o_id\r\n                        })\r\n                        \r\n                        .then(res => {\r\n                                console.log(res);\r\n                                \r\n                                \r\n                        })\r\n                       \r\n                        .catch(err => {\r\n                            console.log(err.response);\r\n                        });\r\n\r\n\r\n                } else {\r\n                    alert(\"payment not succesfull\")\r\n                }\r\n                alert(response.razorpay_signature)\r\n                alert(response.razorpay_payment_id)\r\n                alert(data.o_id)\r\n\r\n\r\n\r\n            },\r\n\r\n            prefill: {\r\n                name: user.name,\r\n                email: user.email,\r\n                phone_number: user.phone\r\n            }\r\n        }\r\n\r\n\r\n        const paymentObject = new window.Razorpay(options)\r\n        paymentObject.open()\r\n    }\r\n\r\n    \r\n\r\n\r\n    return (\r\n        <div className='div h-screen bg-gray-100'>\r\n\r\n            <div className='h-full w-full flex tab-port:flex-col'>\r\n                <div className='w-full h-full bg-gray-100 py-6 px-3 '  >\r\n\r\n                    <div className='flex items-center font-light' >\r\n                        <Link to='/shop'>\r\n                            <svg xmlns='http://www.w3.org/2000/svg' className='h-5 w-5' fill='none' viewBox='0 0 24 24' stroke='currentColor'>\r\n                                <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M15 19l-7-7 7-7' />\r\n                            </svg>\r\n                        </Link>\r\n\r\n                        <button><Link to='/shop'>Back to cart</Link></button>\r\n                    </div>\r\n\r\n\r\n\r\n                    <span className='mt-3 block'>Shipping address </span>\r\n\r\n                    <div>\r\n                        {\r\n                            user?.address.map((addr, i) => (\r\n                                <div key={i} className='w-full h-10  flex items-center justify-between px-2 bg-white shadow-sm mt-3'>\r\n                                    <div className='flex space-x-2 items-center'>\r\n                                        <div className='rounded-full h-4 w-4 border-2 border-gray-700 '>\r\n\r\n                                        </div>\r\n\r\n                                        <div className='text-sm truncate text-gray-500 '>{addr}</div>\r\n                                    </div>\r\n\r\n\r\n                                    <div className='flex space-x-2  '>\r\n                                        <Link to='/profile' className='text-sm text-purple-600 block'> Edit</Link>\r\n                                    </div>\r\n\r\n                                </div>\r\n                            ))\r\n                        }\r\n\r\n\r\n                        <div className='w-full py-1  justify-between px-2 bg-white shadow-sm mt-3'>\r\n\r\n                            <div className='flex  mb-2 pt-2'>\r\n                                <input type='checkbox' className='hidden' onChange={e => setAddressFormDisplay(e.target.checked)} id='addnew' />\r\n                                <label htmlFor='addnew' className='rounded-full h-4 w-4 border-2 border-gray-700 flex justify-center items-center p-[1px]'>\r\n                                    <div className={`rounded-full bg-purple-700 h-full w-full ${addressFormDisplay ? '' : 'hidden'}`}>\r\n                                    </div>\r\n                                </label>\r\n                                <div className='text-sm truncate text-gray-500 ml-2'>Add New Address </div>\r\n\r\n\r\n                            </div>\r\n                            <form onSubmit={async e => {\r\n                                e.preventDefault();\r\n\r\n                                let addr = [\r\n                                    e.target['address'].value,\r\n                                    e.target['city'].value,\r\n                                    e.target['state'].value,\r\n                                    e.target['zip'].value\r\n                                ].join(' ');\r\n\r\n                                try {\r\n                                    const response = await axios.patch('users/me', { address: [...user.address, addr] });\r\n\r\n                                    setUser(response.data.data.user);\r\n                                }\r\n                                catch (err) {\r\n                                    console.log(err);\r\n                                    console.log(err.response);\r\n                                    console.log(err.response?.data);\r\n                                }\r\n                            }}\r\n                            >\r\n                                <div className={addressFormDisplay ? '' : 'hidden'}>\r\n                                    <div className='w-full   mb-2'>\r\n                                        <label className='block uppercase tracking-wide text-gray-700 text-xs font-bold  mb-1' >\r\n                                            ADDRESS\r\n                                        </label>\r\n                                        <input id='address' className='appearance-none block w-full bg-gray-200 text-gray-700 border focus:border-solid  focus:border-purple-500 rounded py-2 px-4  leading-tight focus:outline-none focus:bg-white' type='text' placeholder='street' required={true} />\r\n                                    </div>\r\n\r\n\r\n\r\n                                    <div className='flex mx-3 mb-2'>\r\n                                        <div className='w-full md:w-1/3 px-3 mb-3 md:mb-0'>\r\n                                            <label className='block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2' for='grid-city'>\r\n                                                City\r\n                                            </label>\r\n                                            <input id='city' className='appearance-none block w-full bg-gray-200 text-gray-700 focus:border-solid border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white  focus:border-purple-500' type='text' placeholder='Vadodara'>\r\n                                            </input>\r\n                                        </div>\r\n                                        <div className='w-full md:w-1/3 px-3 mb-3 md:mb-0'>\r\n                                            <label className='block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2' for='grid-city'>\r\n                                                State\r\n                                            </label>\r\n                                            <input id='state' className='appearance-none block w-full bg-gray-200 text-gray-700 focus:border-solid border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white  focus:border-purple-500 ' type='text' placeholder='Gujarat'>\r\n                                            </input>\r\n                                        </div>\r\n                                        <div className='w-full md:w-1/3 px-3 mb-3 md:mb-0'>\r\n                                            <label className='block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2' for='grid-zip'>\r\n                                                Zip\r\n                                            </label>\r\n                                            <input id='zip' className='appearance-none block w-full bg-gray-200 text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight focus:outline-none focus:bg-white focus:border-purple-500 focus:border-solid' type='text' placeholder='90210'></input>\r\n                                        </div>\r\n                                    </div>\r\n                                    <div className='flex justify-end space-x-5 mr-5 mt-5 mb-4'>\r\n                                        <button className='bg-transparent hover:bg-purple-500 text-purple-700 font-semibold hover:text-white py-2 px-4 border border-purple-500 hover:border-transparent rounded'>\r\n                                            Reset\r\n                                        </button>\r\n\r\n                                        <button className='bg-purple-200 hover:bg-purple-500 text-purple-700 font-semibold hover:text-white py-2 px-4 border border-purple-500 rounded'>\r\n                                            Save\r\n                                        </button>\r\n\r\n\r\n\r\n                                    </div>\r\n\r\n\r\n                                </div>\r\n\r\n\r\n                            </form>\r\n\r\n\r\n\r\n                        </div>\r\n\r\n\r\n\r\n                    </div>\r\n\r\n                    <div>\r\n\r\n\r\n                        <span className='mt-10 block '>Payment Method  </span>\r\n\r\n                        <div className=''>\r\n                            <div className='w-full h-10  flex items-center justify-between px-2 bg-white shadow-sm mt-3'>\r\n\r\n                                <div className='flex space-x-2 items-center'>\r\n                                    <input type=\"radio\" class=\"form-radio h-4 w-4\" name=\"accountType\" value=\"personal\" id='offline' />\r\n\r\n\r\n                                    <div className='text-sm truncate text-gray-500 '>Debit or Credit Card </div>\r\n                                </div>\r\n\r\n\r\n                            </div>\r\n\r\n                            <div className='w-full h-10  flex items-center justify-between px-2 bg-white shadow-sm mt-3'>\r\n\r\n                                <div className='flex space-x-2 items-center'>\r\n                                    <label class=\"inline-flex items-center\">\r\n                                        <input type=\"radio\" className='form-radio text-purple-400 h-4 w-4' name=\"accountType\" value=\"personal\" id='offline' />\r\n\r\n                                    </label>\r\n                                    <div className='text-sm truncate text-gray-500 '>Cash On Delivery  </div>\r\n                                </div>\r\n\r\n                            </div>\r\n\r\n                        </div>\r\n\r\n                    </div>\r\n\r\n                </div>\r\n                {\r\n                    Details\r\n                        ?\r\n                        <div className='w-2/3 h-full px-4 mt-8 tab-port:w-full'>\r\n\r\n                            <div className='bg-white w-full py-8 flex flex-col px-3 '>\r\n\r\n                                <span className=''> Order Summary </span>\r\n\r\n                                <div className='text-sm font-normal  mt-4'>\r\n                                    <div className='flex justify-between'>\r\n                                        <div>\r\n                                            <span >Items</span>\r\n                                            <span> ():</span>\r\n                                        </div>\r\n\r\n                                        <span>₹{Details.totalPrice || 0}</span>\r\n                                    </div>\r\n\r\n                                    <div className='flex justify-between'>\r\n                                        <div>\r\n                                            <span >Shipping & Handling </span>\r\n\r\n                                        </div>\r\n\r\n                                        <span>₹23</span>\r\n                                    </div>\r\n\r\n                                    <div className='flex justify-between'>\r\n                                        <div>\r\n                                            <span >tax</span>\r\n\r\n                                        </div>\r\n\r\n                                        <span>₹12</span>\r\n                                    </div>\r\n\r\n                                    <div className='border-2 mx-3 mt-6'></div>\r\n\r\n                                    <div className='flex justify-between text-base mt-4'>\r\n                                        <div>\r\n                                            <span >Total</span>\r\n\r\n                                        </div>\r\n\r\n                                        <span>₹{(Details.totalPrice + Details.totalPrice / 10) || 0}</span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className='flex flex-col space-y-2'>\r\n                                    <button className='bg-purple-400 px-8 py-2 rounded mt-4 text-white' onClick={displayRazorpay}>Place Order</button>\r\n\r\n                                    <p className='text-xs font-light text-gray-500'>By placing your order agree to our company <span className='underline'>Privacy policy</span>  and <span className='underline'>Conditions of use</span></p>\r\n                                </div>\r\n                            </div>\r\n\r\n                        </div>\r\n                        : <></>\r\n                }\r\n\r\n            </div>\r\n\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport default Checkout;"],"names":["loadScript","src","Promise","resolve","script","document","createElement","onload","onerror","body","appendChild","useState","Details","setDetails","addressFormDisplay","setAddressFormDisplay","user","setUser","setCart","alert","fetch","method","then","t","json","data","console","log","options","key","currency","amount","order_id","o_id","name","description","image","handler","response","razorpay_payment_id","axios","payment_id","razorpay_signature","oder_id","res","catch","err","prefill","email","phone_number","phone","window","Razorpay","open","useEffect","isLoggedIn","navigate","cart","className","to","xmlns","fill","viewBox","stroke","d","address","map","addr","i","type","onChange","e","target","checked","id","htmlFor","onSubmit","preventDefault","value","join","placeholder","required","for","class","totalPrice","onClick"],"sourceRoot":""}